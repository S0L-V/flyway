name: Discord PR Notify (opened + merged)

on:
  pull_request:
    types: [opened, closed]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Send Discord notification
        env:
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          # PR OPENED
          if [ "${{ github.event.action }}" = "opened" ]; then
            MSG="ğŸ†• PR ìƒì„±\n**#${{ github.event.pull_request.number }} ${{ github.event.pull_request.title }}**\n${{ github.event.pull_request.html_url }}\nì‘ì„±ì: ${{ github.actor }}"
          fi

          # PR CLOSED (merged only)
          if [ "${{ github.event.action }}" = "closed" ]; then
            if [ "${{ github.event.pull_request.merged }}" = "true" ]; then
              MSG="âœ… PR ë¨¸ì§€ë¨\n**#${{ github.event.pull_request.number }} ${{ github.event.pull_request.title }}**\n${{ github.event.pull_request.html_url }}\në¨¸ì§€í•œ ì‚¬ëŒ: ${{ github.actor }}"
            else
              exit 0
            fi
          fi

          curl -sS -X POST \
            -H "Content-Type: application/json" \
            -d "{\"content\":\"$MSG\"}" \
            "$DISCORD_WEBHOOK_URL"
